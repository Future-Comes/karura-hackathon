module.exports = class Init1658989850334 {
  name = 'Init1658989850334'

  async up(db) {
    await db.query(`CREATE TABLE "coin_gecko" ("id" character varying NOT NULL, "symbol" text NOT NULL, "name" text NOT NULL, "price" numeric, "updated_at" numeric, CONSTRAINT "PK_f8402c1abb7f2fc7f86739bb855" PRIMARY KEY ("id"))`)
    await db.query(`CREATE TABLE "curr_volume_day" ("id" character varying NOT NULL, "volume_day_native" numeric NOT NULL, "volume_day_usd" numeric NOT NULL, "timestamp" numeric NOT NULL, "currency_id" character varying NOT NULL, CONSTRAINT "PK_8ec9c8475cb43665ae52199e606" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_93ac589e3c87a5c6510a690dd2" ON "curr_volume_day" ("currency_id") `)
    await db.query(`CREATE TABLE "curr_liquidity" ("id" character varying NOT NULL, "timestamp" numeric NOT NULL, "liquidity" numeric NOT NULL, "liquidity_usd" numeric NOT NULL, "currency_id" character varying NOT NULL, CONSTRAINT "PK_c80cc5b8686e0894e99e6edad77" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_e17ad5c686feb6cd4e4840ce48" ON "curr_liquidity" ("currency_id") `)
    await db.query(`CREATE TABLE "curr_price" ("id" character varying NOT NULL, "usd_price" numeric NOT NULL, "timestamp" numeric NOT NULL, "currency_id" character varying NOT NULL, CONSTRAINT "PK_b53f40555618333760c322f4686" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_48a6a61594cc62fc3e5e54bd48" ON "curr_price" ("currency_id") `)
    await db.query(`CREATE TABLE "pool_volume_day" ("id" character varying NOT NULL, "volume_day_usd" numeric NOT NULL, "timestamp" numeric NOT NULL, "pool_id" character varying NOT NULL, CONSTRAINT "PK_5d77fbdac354859655b14e818ae" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_4f065e19318d1e86b6699fdb4b" ON "pool_volume_day" ("pool_id") `)
    await db.query(`CREATE TABLE "pool_liquidity" ("id" character varying NOT NULL, "usd_price_zero" numeric NOT NULL, "usd_price_one" numeric NOT NULL, "usd_total_liquidity" numeric NOT NULL, "timestamp" numeric NOT NULL, "pool_id" character varying NOT NULL, CONSTRAINT "PK_cb62efc910a2325642f4de1b7b4" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_09772a4143d40063de22a1d556" ON "pool_liquidity" ("pool_id") `)
    await db.query(`CREATE TABLE "pool" ("id" character varying NOT NULL, "currency_zero_id" character varying NOT NULL, "currency_one_id" character varying NOT NULL, CONSTRAINT "PK_db1bfe411e1516c01120b85f8fe" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_b82075ca2eb663aad1e2789c74" ON "pool" ("currency_zero_id") `)
    await db.query(`CREATE INDEX "IDX_d17bc6590f09c687917fbfc015" ON "pool" ("currency_one_id") `)
    await db.query(`CREATE TABLE "liquidity_change" ("id" character varying NOT NULL, "timestamp" numeric NOT NULL, "block_number" integer NOT NULL, "event_idx" integer NOT NULL, "step" integer NOT NULL, "reason" character varying(6) NOT NULL, "amount_zero" numeric NOT NULL, "amount_one" numeric NOT NULL, "balance_zero" numeric NOT NULL, "balance_one" numeric NOT NULL, "total_value" numeric NOT NULL, "hash" text, "event_id" text NOT NULL, "account" text, "currency_zero_id" character varying NOT NULL, "currency_one_id" character varying NOT NULL, "pool_id" character varying NOT NULL, CONSTRAINT "PK_470573b79a4d135580c7e7c8179" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_34fcef5a4c43839ff5ea4c062f" ON "liquidity_change" ("currency_zero_id") `)
    await db.query(`CREATE INDEX "IDX_26103a0ae2c17ab7b390eb1ca2" ON "liquidity_change" ("currency_one_id") `)
    await db.query(`CREATE INDEX "IDX_59f7403843cb6443f368122bb8" ON "liquidity_change" ("pool_id") `)
    await db.query(`CREATE TABLE "currency" ("id" character varying NOT NULL, "currency_name" text NOT NULL, "coin_gecko_id" character varying, CONSTRAINT "PK_3cda65c731a6264f0e444cc9b91" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_c6e93b0b659f31e8a504ed14e1" ON "currency" ("coin_gecko_id") `)
    await db.query(`CREATE TABLE "swap" ("id" character varying NOT NULL, "timestamp" numeric NOT NULL, "block_number" integer NOT NULL, "event_idx" integer NOT NULL, "step" integer NOT NULL, "from_amount" numeric NOT NULL, "to_amount" numeric NOT NULL, "from_currency_id" character varying NOT NULL, "to_currency_id" character varying NOT NULL, CONSTRAINT "PK_4a10d0f359339acef77e7f986d9" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_5a104bbdfe48a94a9fd2b81990" ON "swap" ("from_currency_id") `)
    await db.query(`CREATE INDEX "IDX_3b0a35a16b356bc35c147cfe4e" ON "swap" ("to_currency_id") `)
    await db.query(`ALTER TABLE "curr_volume_day" ADD CONSTRAINT "FK_93ac589e3c87a5c6510a690dd23" FOREIGN KEY ("currency_id") REFERENCES "currency"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "curr_liquidity" ADD CONSTRAINT "FK_e17ad5c686feb6cd4e4840ce48e" FOREIGN KEY ("currency_id") REFERENCES "currency"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "curr_price" ADD CONSTRAINT "FK_48a6a61594cc62fc3e5e54bd48d" FOREIGN KEY ("currency_id") REFERENCES "currency"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "pool_volume_day" ADD CONSTRAINT "FK_4f065e19318d1e86b6699fdb4bd" FOREIGN KEY ("pool_id") REFERENCES "pool"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "pool_liquidity" ADD CONSTRAINT "FK_09772a4143d40063de22a1d556e" FOREIGN KEY ("pool_id") REFERENCES "pool"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "pool" ADD CONSTRAINT "FK_b82075ca2eb663aad1e2789c74a" FOREIGN KEY ("currency_zero_id") REFERENCES "currency"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "pool" ADD CONSTRAINT "FK_d17bc6590f09c687917fbfc0150" FOREIGN KEY ("currency_one_id") REFERENCES "currency"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "liquidity_change" ADD CONSTRAINT "FK_34fcef5a4c43839ff5ea4c062ff" FOREIGN KEY ("currency_zero_id") REFERENCES "currency"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "liquidity_change" ADD CONSTRAINT "FK_26103a0ae2c17ab7b390eb1ca2f" FOREIGN KEY ("currency_one_id") REFERENCES "currency"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "liquidity_change" ADD CONSTRAINT "FK_59f7403843cb6443f368122bb89" FOREIGN KEY ("pool_id") REFERENCES "pool"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "currency" ADD CONSTRAINT "FK_c6e93b0b659f31e8a504ed14e19" FOREIGN KEY ("coin_gecko_id") REFERENCES "coin_gecko"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "swap" ADD CONSTRAINT "FK_5a104bbdfe48a94a9fd2b81990a" FOREIGN KEY ("from_currency_id") REFERENCES "currency"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "swap" ADD CONSTRAINT "FK_3b0a35a16b356bc35c147cfe4eb" FOREIGN KEY ("to_currency_id") REFERENCES "currency"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
  }

  async down(db) {
    await db.query(`DROP TABLE "coin_gecko"`)
    await db.query(`DROP TABLE "curr_volume_day"`)
    await db.query(`DROP INDEX "public"."IDX_93ac589e3c87a5c6510a690dd2"`)
    await db.query(`DROP TABLE "curr_liquidity"`)
    await db.query(`DROP INDEX "public"."IDX_e17ad5c686feb6cd4e4840ce48"`)
    await db.query(`DROP TABLE "curr_price"`)
    await db.query(`DROP INDEX "public"."IDX_48a6a61594cc62fc3e5e54bd48"`)
    await db.query(`DROP TABLE "pool_volume_day"`)
    await db.query(`DROP INDEX "public"."IDX_4f065e19318d1e86b6699fdb4b"`)
    await db.query(`DROP TABLE "pool_liquidity"`)
    await db.query(`DROP INDEX "public"."IDX_09772a4143d40063de22a1d556"`)
    await db.query(`DROP TABLE "pool"`)
    await db.query(`DROP INDEX "public"."IDX_b82075ca2eb663aad1e2789c74"`)
    await db.query(`DROP INDEX "public"."IDX_d17bc6590f09c687917fbfc015"`)
    await db.query(`DROP TABLE "liquidity_change"`)
    await db.query(`DROP INDEX "public"."IDX_34fcef5a4c43839ff5ea4c062f"`)
    await db.query(`DROP INDEX "public"."IDX_26103a0ae2c17ab7b390eb1ca2"`)
    await db.query(`DROP INDEX "public"."IDX_59f7403843cb6443f368122bb8"`)
    await db.query(`DROP TABLE "currency"`)
    await db.query(`DROP INDEX "public"."IDX_c6e93b0b659f31e8a504ed14e1"`)
    await db.query(`DROP TABLE "swap"`)
    await db.query(`DROP INDEX "public"."IDX_5a104bbdfe48a94a9fd2b81990"`)
    await db.query(`DROP INDEX "public"."IDX_3b0a35a16b356bc35c147cfe4e"`)
    await db.query(`ALTER TABLE "curr_volume_day" DROP CONSTRAINT "FK_93ac589e3c87a5c6510a690dd23"`)
    await db.query(`ALTER TABLE "curr_liquidity" DROP CONSTRAINT "FK_e17ad5c686feb6cd4e4840ce48e"`)
    await db.query(`ALTER TABLE "curr_price" DROP CONSTRAINT "FK_48a6a61594cc62fc3e5e54bd48d"`)
    await db.query(`ALTER TABLE "pool_volume_day" DROP CONSTRAINT "FK_4f065e19318d1e86b6699fdb4bd"`)
    await db.query(`ALTER TABLE "pool_liquidity" DROP CONSTRAINT "FK_09772a4143d40063de22a1d556e"`)
    await db.query(`ALTER TABLE "pool" DROP CONSTRAINT "FK_b82075ca2eb663aad1e2789c74a"`)
    await db.query(`ALTER TABLE "pool" DROP CONSTRAINT "FK_d17bc6590f09c687917fbfc0150"`)
    await db.query(`ALTER TABLE "liquidity_change" DROP CONSTRAINT "FK_34fcef5a4c43839ff5ea4c062ff"`)
    await db.query(`ALTER TABLE "liquidity_change" DROP CONSTRAINT "FK_26103a0ae2c17ab7b390eb1ca2f"`)
    await db.query(`ALTER TABLE "liquidity_change" DROP CONSTRAINT "FK_59f7403843cb6443f368122bb89"`)
    await db.query(`ALTER TABLE "currency" DROP CONSTRAINT "FK_c6e93b0b659f31e8a504ed14e19"`)
    await db.query(`ALTER TABLE "swap" DROP CONSTRAINT "FK_5a104bbdfe48a94a9fd2b81990a"`)
    await db.query(`ALTER TABLE "swap" DROP CONSTRAINT "FK_3b0a35a16b356bc35c147cfe4eb"`)
  }
}
